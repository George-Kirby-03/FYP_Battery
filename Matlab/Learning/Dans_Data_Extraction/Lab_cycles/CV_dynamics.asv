function dx = CV_dynamics(t, y, param)
R0 = param.r0;
R1 = param.r1;
C = param.c;
Q = param.q;
v_ulim = param.vu;
v_llim = param.vl;
ocv_curve = param.ocv;
dx3 = 0;
current = (v_ulim - polyval(ocv_curve,y(1)) - y(2))/R0;
%% Below conditions to ensure unsafe voltages not reached 
if (v < v_llim) && current < 0
    current = 0;
    dx3 = 1;
end
if (y(1) > 1) && current > 0
    current = 0;
    dx3 = 1;
end

dx1 = current./Q;
dx2 = -y(2)./(R1.*C) + current./C;

dx = [dx1; dx2; dx3;];
end
